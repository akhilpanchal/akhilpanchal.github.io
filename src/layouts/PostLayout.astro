---
import BaseLayout from './BaseLayout.astro';
import { calculateReadingTime } from '@/lib/utils';

interface Props {
  title: string;
  description?: string;
  date: Date;
  author?: string;
  image?: {
    url: string;
    alt: string;
  };
  tags?: string[];
  content?: string; // Raw content for reading time calculation
}

const { title, description, date, author, image, tags, content } = Astro.props;


const formattedDate = new Intl.DateTimeFormat('en-US', {
  month: 'long',
  day: 'numeric',
  year: 'numeric',
}).format(date);

// Calculate reading time if content is provided
const readingTime = content ? calculateReadingTime(content) : null;
---

<BaseLayout title={title}>
  
  <main class="flex-1 max-w-4xl mx-auto px-4 py-12 w-full">
    <article>
      <header class="mb-8">
        <h1 class="text-4xl font-bold mb-4">{title}</h1>
        
        {description && (
          <p class="text-xl text-muted-foreground mb-4 border-b border-border pb-4">
            {description}
          </p>
        )}
        
        <div class="flex items-center gap-2 text-sm text-muted-foreground mb-6">
          {author && (
            <>
              <span>{author}</span>
              <span>•</span>
            </>
          )}
          <time datetime={date.toISOString()}>{formattedDate}</time>
          {readingTime && (
            <>
              <span>•</span>
              <span>{readingTime} min read</span>
            </>
          )}
        </div>
        
        {tags && tags.length > 0 && (
          <div class="flex flex-wrap gap-2 mb-6">
            {tags.map((tag) => (
              <span class="text-sm text-primary">#{tag}</span>
            ))}
          </div>
        )}
        
        {image && (
          <div class="mb-8 -mx-4 sm:mx-0">
            <img 
              src={image.url} 
              alt={image.alt}
              class="w-full rounded-lg object-cover"
              loading="eager"
            />
          </div>
        )}
      </header>
      
      <div class="post-content prose prose-lg dark:prose-invert max-w-none">
        <slot />
      </div>
    </article>
  </main>
</BaseLayout>
